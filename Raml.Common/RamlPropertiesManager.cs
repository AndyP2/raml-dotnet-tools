using System;
using System.IO;

namespace Raml.Common
{
    public class RamlPropertiesManager
    {
        public static RamlProperties Load(string refFilePath)
        {
            return new RamlProperties
            {
                Namespace = RamlReferenceReader.GetRamlNamespace(refFilePath),
                Source = RamlReferenceReader.GetRamlSource(refFilePath)
            };
        }

        public static void Save(RamlProperties props, string refFilePath)
        {
            var contents = BuildContent(props.Namespace, props.Source);
            var fileInfo = new FileInfo(refFilePath) { IsReadOnly = false };
            File.WriteAllText(refFilePath, contents);
            fileInfo.IsReadOnly = true;
        }

        public static string BuildContent(string targetNamespace, string ramlOriginalSource)
        {
            var content = string.Format("// do not edit this file{0}source: {1}{0}namespace: {2}{0}",
                Environment.NewLine, ramlOriginalSource, targetNamespace);
            return content;
        }

    }
}